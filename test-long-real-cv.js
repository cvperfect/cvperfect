// Test with realistic long CV to confirm no truncation
const testLongCV = async () => {
  const longCV = `KONRAD JAK√ìBCZAK
Frontend Developer | React Specialist | Team Leader

üìû +48 123 456 789
üìß konrad.jakobczak@example.com
üåê linkedin.com/in/konradjakobczak
üè† Warszawa, Polska

PODSUMOWANIE ZAWODOWE:
Do≈õwiadczony Frontend Developer z 5-letnim do≈õwiadczeniem w tworzeniu skalowalnych aplikacji webowych. Specjalista React z umiejƒôtno≈õciami team lead. Pasjonat nowych technologii i clean code.

DO≈öWIADCZENIE ZAWODOWE:

Senior Frontend Developer | TechCorp Sp. z o.o. | 2019-2024
‚Ä¢ Tworzenie aplikacji React dla klient√≥w enterprise (15+ projekt√≥w)
‚Ä¢ Optymalizacja wydajno≈õci aplikacji - redukcja czasu ≈Çadowania o 40%
‚Ä¢ Mentoring zespo≈Çu 5 junior developer√≥w
‚Ä¢ Wdra≈ºanie CI/CD pipeline dla frontendowych projekt√≥w
‚Ä¢ Wsp√≥≈Çpraca z UX/UI designerami w procesie design thinking
‚Ä¢ Code review i zapewnianie jako≈õci kodu
‚Ä¢ Migracja legacy aplikacji z jQuery do React

Frontend Developer | StartupXYZ | 2017-2019
‚Ä¢ Rozw√≥j MVP produktu fintech od podstaw
‚Ä¢ Integracja z REST API i GraphQL
‚Ä¢ Implementacja responsywnego designu
‚Ä¢ Testowanie jednostkowe i e2e (Jest, Cypress)
‚Ä¢ Wsp√≥≈Çpraca w zespole Agile/Scrum
‚Ä¢ Utrzymanie 95% pokrycia testami

Junior Web Developer | WebAgency | 2016-2017
‚Ä¢ Tworzenie stron internetowych dla ma≈Çych firm
‚Ä¢ Rozw√≥j umiejƒôtno≈õci HTML, CSS, JavaScript
‚Ä¢ Nauka pracy z klientem i zarzƒÖdzanie projektami
‚Ä¢ Optymalizacja SEO i performance

WYKSZTA≈ÅCENIE:

Magister Informatyki | Politechnika Warszawska | 2014-2018
Specjalizacja: In≈ºynieria Oprogramowania
Praca dyplomowa: "Optymalizacja aplikacji React w ≈õrodowisku produkcyjnym"
≈örednia ocen: 4.8/5.0

Licencjat Informatyki | Politechnika Warszawska | 2010-2014
Specjalizacja: Systemy Informatyczne
≈örednia ocen: 4.5/5.0

UMIEJƒòTNO≈öCI TECHNICZNE:

Frontend:
‚Ä¢ JavaScript (ES6+), TypeScript - ekspert
‚Ä¢ React, Redux, React Query - ekspert  
‚Ä¢ Vue.js, Vuex - zaawansowany
‚Ä¢ HTML5, CSS3, SASS/SCSS - ekspert
‚Ä¢ Webpack, Vite, Parcel - zaawansowany
‚Ä¢ Responsive Web Design - ekspert

Backend:
‚Ä¢ Node.js, Express.js - ≈õredniozaawansowany
‚Ä¢ GraphQL, REST API - zaawansowany
‚Ä¢ Bazy danych: MongoDB, PostgreSQL - podstawowy

DevOps & Tools:
‚Ä¢ Git, GitHub, GitLab - ekspert
‚Ä¢ Docker, Docker Compose - podstawowy  
‚Ä¢ AWS (S3, CloudFront, EC2) - podstawowy
‚Ä¢ CI/CD (GitHub Actions, GitLab CI) - ≈õredniozaawansowany

Testing:
‚Ä¢ Jest, React Testing Library - zaawansowany
‚Ä¢ Cypress, Playwright - ≈õredniozaawansowany
‚Ä¢ Storybook - ≈õredniozaawansowany

CERTYFIKATY I KURSY:

‚Ä¢ AWS Certified Developer Associate (2023)
‚Ä¢ React Professional Certificate - Meta (2022)
‚Ä¢ Advanced JavaScript Concepts - Udemy (2021)
‚Ä¢ GraphQL with React Course (2020)
‚Ä¢ Agile/Scrum Master Certification (2019)

JƒòZYKI:

‚Ä¢ Polski - jƒôzyk ojczysty
‚Ä¢ Angielski - C1 (certyfikat Cambridge)
‚Ä¢ Niemiecki - A2 (podstawowy)

KLUCZOWE PROJEKTY:

1. E-commerce Platform (2023-2024)
Rola: Tech Lead
Stack: React, TypeScript, Redux Toolkit, Node.js
‚Ä¢ Platforma sprzeda≈ºowa obs≈ÇugujƒÖca 50,000+ u≈ºytkownik√≥w
‚Ä¢ Implementacja real-time inventory management
‚Ä¢ Integracja z systemami p≈Çatno≈õci (Stripe, PayU)
‚Ä¢ Optymalizacja wydajno≈õci - 99.9% uptime

2. Banking Dashboard (2022-2023)  
Rola: Senior Frontend Developer
Stack: React, TypeScript, GraphQL, Material-UI
‚Ä¢ Dashboard dla klient√≥w banku z real-time danymi
‚Ä¢ Implementacja zaawansowanych wykres√≥w (D3.js)
‚Ä¢ Bezpiecze≈Ñstwo - implementacja 2FA
‚Ä¢ Dostƒôpno≈õƒá WCAG 2.1 AA

3. SaaS Analytics Tool (2021-2022)
Rola: Frontend Developer
Stack: Vue.js, Vuex, Chart.js, Express.js
‚Ä¢ Narzƒôdzie analityczne dla marketingowc√≥w
‚Ä¢ Real-time data visualization
‚Ä¢ Export danych do PDF/Excel
‚Ä¢ Integracja z Google Analytics API

4. COVID-19 Tracker (2020) - Projekt Open Source
Rola: Maintainer
Stack: React, TypeScript, REST API
‚Ä¢ Aplikacja ≈õledzƒÖca statystyki COVID-19
‚Ä¢ 10,000+ daily active users
‚Ä¢ Wsp√≥≈Çpraca z 15+ developerami worldwide
‚Ä¢ GitHub: 500+ stars

DODATKOWE UMIEJƒòTNO≈öCI:

‚Ä¢ ZarzƒÖdzanie zespo≈Çem (5+ os√≥b)
‚Ä¢ Mentoring i szkolenie junior developer√≥w  
‚Ä¢ Code review i zapewnianie jako≈õci kodu
‚Ä¢ Agile/Scrum methodology
‚Ä¢ Client communication w jƒôzyku angielskim
‚Ä¢ Technical writing i dokumentacja
‚Ä¢ Performance optimization
‚Ä¢ SEO basics

ZAINTERESOWANIA:

‚Ä¢ Open Source contributing (GitHub: 50+ contributions)
‚Ä¢ Tech blogging (Medium: 25+ artyku≈Ç√≥w)
‚Ä¢ Konferencje IT (4Developers, React Warsaw)
‚Ä¢ Fotografia (hobby)
‚Ä¢ Bieganie (maraton PZU 2023)

REFERENCJE:

Dostƒôpne na ≈ºyczenie wraz z portfolio projekt√≥w.`;

  try {
    console.log(`üìù Testing with LONG CV: ${longCV.length} characters`);
    
    const response = await fetch('http://localhost:3000/api/analyze', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        currentCV: longCV,
        email: 'test@premium.com',
        paid: true,
        jobPosting: 'Senior React Developer - Leading tech company seeks experienced frontend developer with React, TypeScript, team leadership skills, and experience with large-scale applications.'
      })
    });

    const data = await response.json();
    
    console.log('\nüìä LONG CV TEST RESULTS:');
    console.log('========================');
    console.log(`‚úÖ Success: ${data.success}`);
    console.log(`üìù Original CV: ${longCV.length} chars`);
    console.log(`ü§ñ Optimized CV: ${data.optimizedCV?.length || 0} chars`);
    console.log(`üìà Length ratio: ${data.optimizedCV ? (data.optimizedCV.length / longCV.length * 100).toFixed(1) : 0}%`);
    
    // Check key sections
    const keyContent = [
      'REFERENCJE',
      'ZAINTERESOWANIA', 
      'PROJEKTY',
      'CERTYFIKATY',
      'UMIEJƒòTNO≈öCI'
    ];
    
    console.log('\nüîç KEY SECTIONS CHECK:');
    keyContent.forEach(section => {
      const found = data.optimizedCV?.includes(section) || 
                   data.optimizedCV?.toLowerCase().includes(section.toLowerCase());
      console.log(`${found ? '‚úÖ' : '‚ùå'} ${section}`);
    });
    
    // Check if it ends properly
    const lastChars = data.optimizedCV?.slice(-100) || '';
    console.log('\nüèÅ ENDING CHECK:');
    console.log(`Last 100 chars: "${lastChars}"`);
    
    const endsWell = lastChars.includes('</') || lastChars.includes('Ref') || lastChars.includes('portfolio');
    console.log(`${endsWell ? '‚úÖ' : '‚ùå'} CV ends properly`);
    
  } catch (error) {
    console.error('‚ùå Test failed:', error.message);
  }
};

testLongCV();